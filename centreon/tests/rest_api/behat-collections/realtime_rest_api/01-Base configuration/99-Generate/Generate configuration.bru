meta {
  name: Generate configuration
  type: http
  seq: 1
}

post {
  url: http://{{url}}/centreon/api/index.php?action=action&object=centreon_clapi
  body: json
  auth: none
}

query {
  action: action
  object: centreon_clapi
}

headers {
  Content-Type: application/json
  centreon-auth-token: {{token}}
}

body:json {
  {
    "action": "APPLYCFG",
    "values": "Central"
  }
}

tests {
  tests["Status code is 200"] = res.getStatus() === 200;
  
  function wait(millis) {
    var date = new Date();
    var curDate = null;
    do { curDate = new Date(); }
    while(curDate-date < millis);
  }
  
  wait(10000);
}
