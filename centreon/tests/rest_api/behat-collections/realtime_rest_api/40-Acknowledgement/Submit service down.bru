meta {
  name: Submit service down
  type: http
  seq: 2
}

post {
  url: http://{{url}}/centreon/api/index.php?action=submit&object=centreon_submit_results
  body: json
  auth: none
}

query {
  action: submit
  object: centreon_submit_results
}

headers {
  Content-Type: application/json
  centreon-auth-token: {{token}}
}

body:json {
  {
  	"results" : {
  		"ack": {
  			"host":"ack_host",
  			"service":"ack_service",
  			"status":"1",
  			"output": "down",
  			"updatetime": "1528884076"
  		}
  	}
  }
}

tests {
  tests["Status code is 200"] = res.getStatus() === 200;
  
  function wait(millis) {
    var date = new Date();
    var curDate = null;
    do { curDate = new Date(); }
    while(curDate-date < millis);
  }
  
  wait(5000);
}
