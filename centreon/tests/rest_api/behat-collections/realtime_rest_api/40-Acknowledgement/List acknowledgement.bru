meta {
  name: List acknowledgement
  type: http
  seq: 5
}

post {
  url: http://{{url}}/centreon/api/index.php?action=action&object=centreon_clapi
  body: json
  auth: none
}

query {
  action: action
  object: centreon_clapi
}

headers {
  Content-Type: application/json
  centreon-auth-token: {{token}}
}

body:json {
  {
    "action": "show",
    "object": "RTACKNOWLEDGEMENT"
  }
}

tests {
  tests["Status code is 200"] = res.getStatus() === 200;
  
  var contentType = postman.getResponseHeader("Content-Type");
  tests["Content-Type is application/json"] = contentType === "application/json;charset=utf-8";
  
  var jsonData = JSON.parse(responseBody);
  var result= jsonData.result;
  
  var schema = {
      "$schema": "http://json-schema.org/draft-04/schema#",
      "type": "array",
      "items": {
          "type": "object",
          "properties": {
              "hosts": { "type": "string" },
              "services": { "type": "string" }
          },
          "additionalProperties": false,
          "required ": ["hosts"]
      }
  };
  
  tests["Validate schema"] = tv4.validate(result, schema);
  
  function wait(millis) {
    var date = new Date();
    var curDate = null;
    do { curDate = new Date(); }
    while(curDate-date < millis);
  }
   
}
